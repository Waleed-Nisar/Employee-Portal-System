@model IEnumerable<EPS.Application.DTOs.LeaveDto>

@{
    ViewData["Title"] = "Pending Leaves";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-md-6">
            <h2>Pending Leave Approvals</h2>
            <p class="text-muted">Review and approve leave requests</p>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            @if (Model.Any())
            {
                @foreach (var leave in Model)
                {
                    <div class="card mb-3 border-warning">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-8">
                                    <h5>@leave.EmployeeName</h5>
                                    <p class="mb-2">
                                        <span class="badge bg-info">@leave.LeaveTypeDisplay</span>
                                        <span class="badge bg-secondary">@leave.TotalDays days</span>
                                    </p>
                                    <p class="mb-2">
                                        <i class="bi bi-calendar me-2"></i>
                                        <strong>From:</strong> @leave.StartDate.ToString("MMM dd, yyyy")
                                        <strong class="ms-3">To:</strong> @leave.EndDate.ToString("MMM dd, yyyy")
                                    </p>
                                    <p class="mb-0">
                                        <i class="bi bi-chat-left-text me-2"></i>
                                        <strong>Reason:</strong> @leave.Reason
                                    </p>
                                </div>
                                <div class="col-md-4 text-end d-flex flex-column justify-content-center">
                                    <form asp-action="Approve" asp-route-id="@leave.Id" method="post" class="mb-2">
                                        <button type="submit" class="btn btn-success w-100" onclick="return confirm('Approve this leave request?')">
                                            <i class="bi bi-check-circle me-2"></i>Approve
                                        </button>
                                    </form>
                                    <button class="btn btn-danger w-100" data-bs-toggle="modal" data-bs-target="#rejectModal-@leave.Id">
                                        <i class="bi bi-x-circle me-2"></i>Reject
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reject Modal -->
                    <div class="modal fade" id="rejectModal-@leave.Id" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <form asp-action="Reject" asp-route-id="@leave.Id" method="post">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Reject Leave Request</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <p>Are you sure you want to reject this leave request?</p>
                                        <div class="mb-3">
                                            <label class="form-label">Remarks (Optional)</label>
                                            <textarea name="remarks" class="form-control" rows="3" placeholder="Enter reason for rejection..."></textarea>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-danger">Reject Leave</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="text-center text-muted py-5">
                    <i class="bi bi-check-circle fs-1 d-block mb-3"></i>
                    <h5>No Pending Approvals</h5>
                    <p>All leave requests have been processed</p>
                </div>
            }
        </div>
    </div>
</div>